# Гибридный чат-бот с адаптивной сетью и Rust-оптимизацией

## 🎯 Описание проекта

Гибридный чат-бот с локальным ИИ-инференсом, адаптивной сетевой архитектурой и Rust-оптимизацией для TensorRT. Проект состоит из стабильной VDS-части и динамической локальной части, работающей на пользовательском ПК с GPU.

## 🏗️ Архитектурная схема

```
┌─────────────────────────────────────────────────────────────────┐
│                           VDS (Стабильная часть)               │
│                        chat.mehhost.ru (12GB RAM)             │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────┐  │
│  │  API Gateway    │◄──►│  Connection     │◄──►│   Auth      │  │
│  │  (FastAPI)      │    │  Manager        │    │  Service    │  │
│  └─────────────────┘    └─────────────────┘    └─────────────┘  │
│         │                       │                     │         │
│         ▼                       ▼                     ▼         │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────┐  │
│  │  Nginx Proxy    │    │  WebSocket/     │    │  JWT        │  │
│  │                 │    │  Long Polling   │    │  Manager    │  │
│  └─────────────────┘    └─────────────────┘    └─────────────┘  │
└─────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────┐
│                     Локальный ПК (Динамическая часть)           │
│              Windows 11, RTX 4070, i7 14-gen, 32GB RAM         │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────┐  │
│  │  LLM Server     │◄──►│  Rust Core      │◄──►│  TensorRT   │  │
│  │  (FastAPI)      │    │  (PyO3)         │    │  Engine     │  │
│  └─────────────────┘    └─────────────────┘    └─────────────┘  │
│         │                       │                     │         │
│         ▼                       ▼                     ▼         │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────┐  │
│  │  Health Check   │    │  Model Loader   │    │  CUDA       │  │
│  │                 │    │                 │    │  (sm_89)    │  │
│  └─────────────────┘    └─────────────────┘    └─────────────┘  │
└─────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────┐
│                        Сетевая архитектура                      │
├─────────────────────────────────────────────────────────────────┤
│  1. Direct (LAN) - прямое соединение ПК ↔ VDS                  │
│  2. Relay (через VDS) - через reverse proxy                    │
│  3. Offline - автономная работа на ПК                           │
│  4. Hybrid - комбинированный режим                              │
└─────────────────────────────────────────────────────────────────┘
```

## ✨ Особенности

- **Полная приватность**: Нет внешних подписок и облачных сервисов
- **Адаптивная сеть**: Автоопределение режима подключения
- **Rust-оптимизация**: 30%+ прирост производительности через PyO3
- **Адаптивный интерфейс**: Vue3 с поддержкой оффлайн-режима
- **Безопасность**: JWT-аутентификация с offline-верификацией

## 🚀 Структура проекта

```
chatbot-project/
├── .gitignore
├── .env.universal
├── README.md
├── requirements.txt          # VDS зависимости
├── requirements-local.txt    # Локальный ПК зависимости
├── Cargo.toml                # Rust зависимости (для локального ПК)
├── nginx/
│   └── chatbot.conf
├── scripts/
│   ├── deploy_vds.sh
│   ├── setup_local.ps1       # Windows
│   └── setup_local.sh        # Linux/Mac
├── backend/                  # Стабильная VDS часть
├── frontend/                 # Адаптивный фронтенд
└── local-inference/          # Локальный ИИ-инференс (только ПК)
    └── rust-core/            # Rust-оптимизация
```

## 🛠️ Технологии

- **Backend**: Python, FastAPI, WebSockets
- **Frontend**: Vue3, Vite, Pinia
- **Инференс**: TensorRT, CUDA (sm_89 для RTX 4070)
- **Rust**: PyO3, CUDA bindings
- **Сеть**: WebSocket, Long Polling, Auto-detection
- **Безопасность**: JWT, offline verification

## 📋 Режимы работы

1. **Direct (LAN)**: Прямое соединение при наличии локальной сети
2. **Relay**: Через VDS-сервер при NAT/ограничениях
3. **Offline**: Полностью автономная работа на ПК
4. **Hybrid**: Комбинированный режим с оптимальным маршрутизацией

## 🏁 Критерии готовности MVP

- [ ] Регистрация/вход работает с JWT
- [ ] Автоопределение сети при первом запуске
- [ ] Базовый чат-интерфейс с адаптивным дизайном
- [ ] Rust-модуль собирается под RTX 4070
- [ ] Работает в оффлайн-режиме при потере связи